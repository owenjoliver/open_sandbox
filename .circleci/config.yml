version: 2.1
orbs:
  win: circleci/windows@5.0
jobs:
  build:
    executor:
     name: win/default
     shell: powershell.exe
    working_directory: C:\Users\circleci\project
    steps:
        - run: Invoke-WebRequest -Uri https://github.com/owenjoliver/open_sandbox/blob/main/SilentInstall.iss -OutFile C:\Users\circleci\SilentInstall.iss
        - run: dir C:\Users\circleci
        - run: 
            command: |
              Invoke-WebRequest -Uri https://installers.ilok.com/iloklicensemanager/LicenseSupportInstallerWin64.zip -OutFile C:\Users\circleci\License.zip
              Expand-Archive -Path C:\Users\circleci\License.zip -DestinationPath C:\Users\circleci\
            shell: powershell.exe
        - run: 
            command: |
              & 'C:\Users\circleci\LicenseSupportInstallerWin64_v5.7.1_fbd47960\License Support Win64.exe' -s -f1“C:\Users\circleci\SilentInstall.iss”
            shell: powershell.exe
        - run: dir 'C:\Program Files (x86)\'
workflows:
  workflow:
    jobs:
      - build
